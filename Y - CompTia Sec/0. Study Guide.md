## 1. Security
- DAD Triad
	- Disclosure
		- Exposure of sensitive info to unauthorized
	- Alteration
		- Unauthorized modification
	- Denial
		- Disruption of legitimate access

- Security Control Categories
	- Technical
		- Enforce CIA
		- Tuning IPS, firewall rules
	- Operational
		- Manage tech in secure manner. Log monitoring, vuln management, user access review
	- Managerial
		- Mechanics of risk management process. Risk assessments

- Security Control Types:
	- Preventive
		- Before issue (firewall)
	- Detective
		- IDS
	- Corrective
		- Backups from ransomware attack
	- Deterrent
		- Guards
	- Physical
		- Guard
	- Compensating
		- mitigate risk for exceptions

- Data in processing: actively in  use on computer

- DLP
	- Host based DLP
		- Software that looks for sensitive info
	- Network DLP
		- Device monitors outbound traffic
	- Pattern mathcing
	- Watermarking
		- Apply electronic tags to sensitive documents. DLP can then monitor

- Data Obfuscation
	- Tokenization
		- replace sensitive values using lookup table
	- Masking
		- Partially redact sensitive information

- Desired Security State
	- Control objectives

- A. PCI DSS compensating controls must be “above and beyond” other PCI DSS requirements. This specifically bans the use of a control used to meet one requirement as a compensating control for another requirement

## 2. Landscape

- Shadow IT
	- Personnel using unapproved software like file sharing

- OSINT
	- Senki
	- Open threat exchange
	- MISP
	- CISA (Cybersecurty and Infrastructure Security Agency)

- Threat Indicator Management and Exchange
	- STIX
		- Structured Threat Information eXpression
		- Threat description language
		- XML
		- Sponsored by US department of homeland security
		- 12 domain objects
			- Attack patterns, identities, malware, threat actors, and tools
			- relationship or sighting
		- JSON descriptions
		- Now with OASIS (Organisation for the Advancement of Structured Information Standards)
		-  TAXII protocol (Trusted Automated eXchange of Indicator Information)
			- Communicate threat information at application layer
	- OpenIOC
		- XML
		- metadata like the author, the name of the IOC, and a description of the indicator
		- Compromise indicator framework
	- **Information Sharing and Analysis Centers (ISACs**) help infrastructure owners and operators share threat information and provide tools and assistance to their members. The National Council of ISACs lists the sector-based ISACs

- Threat information
	- Timliness, accuracy, relevance

## 3. Malicious Code

- Botnets
	- Many use IRC (Internet Relay Chat)
	- fast flux DNS
		- register and deregister DNS

- logic bomb
	- function or code placed inside a program

- Potentially Unwanted Programs (PUPs)

- ML / AI
	- Tainted data

- VBSCript works within an application

## 5. Vulnerability Management

- Scanning frequency may be  a regulatory requirement
	- Payment Card Industry Data Security Standard (PCI DSS)
	- Federal Information Security Management Act (FISMA)

- Server based scanning
	- Agent based
	- Inside out scan

- Scan perspective
	- Can run from internet

- SCAP (Security Content Automation Protocol)

- Tools
	- Nessus
	- Qualy's
	- Nexpose by rapid7
	- OpenVAS

- Application Scanning
	- Static: analyze code
	- Dynamic: executes code running all interfaces and variety of inputs
	- Interactive: Examine source code while testers interact
	- Fuzzing: Sending invalid or random data
		- Look for crashes, fails or incorrect responses

- CVSS (Commone Vulnerability Scoring Systrem)
	- Exploitablity and impact scores
	- Priviliges required metric
	- CIA scores
	- CVSS Vector
		- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221018072133.png)

- Supplement scans with
	- Log reviews
	- SIEM (Security Information and Event Management)
		- Correlate log entries from multiple entries
	- Configuration managament system

- Credentialled scans require read only account

- Pen testing ROE
	- Timline
	- Locations
	- Data handlign
	- defensive behavious
	- Legal
	- comms

- war driving
	- Drive by with directional antennas to eavesdrop or connect to wireless

## 6. Secure Coding

- SDLC (Software Development Life Cycle)
	- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221018174254.png)


- Secure Coding Practices
	- OWASP (Open Web Application Security Project)

- Fagan inspection
	1.  Planning, including preparation of materials, attendees, and location
	2.  Overview, which prepares the team by reviewing the materials and assigning roles such as coder, reader, reviewer, and moderator
	3.  Preparation, which involves reviewing the code or other item being inspected and documents any issues or questions they may have
	4.  Meeting to identify defects based on the notes from the preparation phase
	5.  Rework to resolve issues
	6.  Follow-up by the moderator to ensure that all issues identified have been found and that no new defects were created during the resolution process

- Session hijacking
	- Using authenticated user's cookie
	- Protect by marking cookies as SECURE (never sent by HTTP)
- NTLM pass the hash


- File Inclusion
	- Executes code in an included file

- Request Forgery
	- Cross-Site Request Forgery (CSRF/XSRF)
		- Execute commands on user's behalf
			- Assumption user is logged into multiple sites at once

- Input validation
	- Input whitelisting

- WAF
	- Recieves netwrok traffic headed to server
	- Input validation

- Normalization of Database
	- 1NF, 2NF, 3NF, ...
	- Design principles
		- Prevent inconsistency
		- Prevent update anonolies
		- Reduce restructuring
		- Make schema more informative

- Paramterised queries
	- Precompiled query template

- Obfuscation & Camoflage
	- minimization
	- tokenization
	- hashing

- Applicaiton resiliance
	- Scalability for increasing demand
	- Elasticity
		- automaticallly provision resources automatically and deprovision when no longer needed

- Remove comments for deployed code that willl show (web)

- Race conditions
	- TOCTTOU (Time of change to time of use)

- shimming
	- Get legitimate driver and wrap malware around it
	- Usually protected against (digital signature)

- Continuous integration
- Continuous delivery
- Agile 
	- Uses these but these don't have to be agile
	- Early and continuous delivery

## 7. Cryptography and PKI

### Symmetric Crypto
- DES : Data Encryption Standard
	- 64 bit block cipher with 56 bit key and 8 bit parity
	- Modes
		- Electronic COdebook (ECB)
			- same blockj -> same encryption
		- Cipher block chaining (CBC)
			- CT from last block combined with PT from next block before encrypt
			- Random initial IV
			- Error progogates
		- Cipher Feedback (CFB)
			- Stream version of CBC filling memory buffer
		- Output Feedback (OFB)
			- Seed value for IV
			- Next seed from previous one
		- Counter (CTR)
			- Counter increments

- Triple DES
	- DES-EEE3 (3 keys)
		- 168 bit 
	- DES-EDE3 (encrpyt decrypt encrypt)

- AES
	- Successor to DES
	- 128 bit - 10 roun
	- 182 bit - 12 round
	- 256 bit - 14 round


### Asymmetric Crypto
- RSA
	- Rivest Shamir Adleman
	- Factoring large primes

### Hashing

- SHA 1 -> 160 bit
	- processed in 512 bit blocks
- SHA3

- HMAC
	- Hashed Message Authentication Code
			- Integrity but not non repudiation (shared key)

- NIST (National Institute of Standards and Technology)
	- specifiy acceptable digital signature algorithms
		- FIPS (Federal Information Processsing Standard) 186-4
			- DSS (Digitial Signature Standard)
			- SHA-3


- Certificates
	- X.509
	- RA - registration Authority - verify identities
		- Enrollment - Proving your ID to CA
	- Certificate chaining with intermediate CAs
	- DV or EV (domain validation) or (extended validation)

- Revoked certificates
	- CRL
	- OCSP (Online Certificate Status Protocol)
		- Certificate Stapling
			- webserver contacts OSCP and gets timestamped approval
			- Usually 24 hours staple
- Certificate Pinning
	- Browsers attach certificate to subject for extended period
	- Provides an expected key

- Cert formats
	- DER
		- Distinguished Encoding Rules
		- .DER, .CRT, .CER
	- PEM
		- Privacy Enhanced Mail
		- .PEM, .CRT
	- PFX
		- Personal Information Exchange
		- Windows
	- P7B
		- Windows
		- ASCII
	- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221018204646.png)

- Backup key
	- Can use key escrow

- Hardware Security Module
	- Stores and manages eys
	- Prevents human working directly with keys

- Attacking
	- Related key : cipher text under two different keys
	- Downgrade : Shift to less secure mode
	- Weak keys : WEP (Wireless Equivalent Privacy)

- Lightweight Crypto
	- Hardware purpose built for little power expenditure as possible
	- Low latency for network

- Homomorphic encryption
	- Encrypt sensitive data
	- Do calculations
	- When decrypted produces same result as if cal done on the unencrypted data

## 8. Identity & Access Management

- EAP (Extensible Authentication Protocol)
	- Wireless networks
	- EAP-TLS, LEAP, EAP-TTLS
- PAP (Password Authentication Protocol)
	- Not used
- CHAP (Chaalenge Handshake Authentication Protocol)
	- 3 way handshake
	- More secure than PAP
	- Microsoft MS-CHAP (deprecated)

- 802.1X
	- IEEE standard
	- client-server model
	- Authenticates for network devices (swithces)
	- Controllers connect via RADIUS to authentication server
		- Uses shared secret
		- Authentication uses protocol like LDAP to speak to directory services
	- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221019073935.png)

- TACACS+
	- Cisco designed extension to TACACS
		- TCP to perform AAA
		- Full packet encrpytion and granular command controls

- Kerberos
	- Users: username, the instance, realm (groups seperated by turst boundaries)
	- KDC : key distribution center
	- Client -> authentication server -> TGT (encrypted with TGS key)
	- Client -> TGT to TGS -> session key for requested service
	- Client -> service
	- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221019074540.png)

- Internet