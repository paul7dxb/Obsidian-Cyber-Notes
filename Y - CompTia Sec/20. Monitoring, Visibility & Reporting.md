# 20. Monitoring, Visibility & Reporting

## Windows Logging & Monitoring
- Event Viewer
	- Warnings, errors, info
	- Can use powershell with event viewer
- Other services create their own logs
	- IIS, exchange
- System Log
	- Warnings, errors, info
	- Logs if user doesn't have permissions for action
- Task manager
	- Process hacker
		- Useful for finding malware
- Secure Configuration Assessment (SCA)
	- Apply security templates
		- NIST, DOD
	- Typically use GPOs
		- Password policies
		- User right assignement
			- Act as part of OS
			- Create token object
			- Remote desktop services
- Automate monitoring with powershell 
	- NetSecurity module
- Thrid party
	- Solarwinds
		- Monitoring, visibility, control tools
		- MSSPs

## Linux Logging & Monitoring
- syslog-ng
	- Newer syslog
	- Takes messsages from various sources then filters and forwards them
- syslogd
	- Reads and logs messages to system console
	- Can read from other machines/users
	- Designated by a configuration file
- logrotate
	- Automatic rotation, compression, disposal and emailing of log files

- auditd
	- Logs command execution on RedHat and SE Linux
	- Command execution
	- file and directory access
	- Network connection
	- Managed by audit.rules or `auditctl`
	- tools
		- ausearch
		- aereport
		- autrace
- netstat
	- Network activity and conections
- ps
	- ps -ef
	- Show running processes
	- `ps -C <processname>`
- top
	- Display processor activity in real time
	- processes running with processor and memory usage

## Cloud Computing Logging & Reporting
- Cloudwatch
	- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221016131108.png)
- Cloudtrail
	- API calls to GUI
- VPC FLow logs
	- Virtual Private Cloud
	- Generated by application elastic load balancing
	- Shows IP addresses making requests to web services
- AWS config
- Systems Manager
	- Dynamic bastion session
	- AWS System manager
		- ![](../ZZ%20-%20Pasted%20Images/Pasted%20image%2020221016131210.png)
- GuardDuty
	- Threat management tools
	- VPC flow logs
	- Real time security managed services against attacks

## Log Aggregation & Collection

- Deduplicating and collecting logs and alerts from many sources
- SIEMs
- SMNP traps
- Netflow collection
	-  version 9 XML extensible
- Next generation IPS
	- AI
- Database acitivtiy monitors
- VPN gateway flow logs
- Next gen syslog tools
- Cloud-based visibility tools
- ML & AI data analysis tools

- Aggregate and Correlate Logs
	- Input validation weakness
	- Authentication attempts
	- Access control failures
	- Tampering attempts
	- Use on invalid or expired session tokens
	- Exceptions raised by OS or application
	- Use of elevated privilieges
	- TLS failures

## Visibility & Reporting Best Practices
- Visualise results for non technical
- As much info is needed but not data overload
- Different reports for different audiences
- Dashboards with R programming
- Visual communication
	- No 3d
	- Palllette of sequential colours
	- Avoid Pie charts
- CSP tools
	- Cloudwatch, cloudtrail, stackdriver, insights
- R and Python
- Automated system reports
	- YAML
- After action reports
	- after actions reports

## Lessons Learned & After-action Reports
- Knowledge gained form conducting program or task 
- Usually held at close out but not exclusively
- Can be documented at any point in the life cycle

- Share knowledge derived from experience
	- Endorse positive
	- Prevent negative outcomes

- Incident Response Reporting
	- Root cause analysis
		- Core reasons for failure
	- Usually performed by the originators of the exercise
	- Analytical AARs goals
		- ID problematic issues and areas for improvement
		- Recommend measures to counteract challenges
		- finding lessons learned

- Forensic Reporting
	- Meet with authorities
		- Provide testimony
		- Clarification
		- ID overall impact on buisness
		- Recommend counter measures
	- Tracking people hours and expenses
		- Who, what, when, how
			- For court preoceedings

- AAR structure
	- Overview
	- Stated objectives
	- Analysis of results
	- Analysis of critical task performance
	- Summary
	- Recommendations